<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jw.shiro.dao.AuthorizationDAO" >
    <resultMap id="BaseResultMapRole" type="com.jw.shiro.bean.TSysRole" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 19 14:01:10 CST 2018.
        -->
        <constructor >
            <idArg column="role_id" jdbcType="BIGINT" javaType="java.lang.Long" />
            <arg column="role" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="description" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="available" jdbcType="BIT" javaType="java.lang.Boolean" />
            <arg column="crt_time" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
            <arg column="modf_time" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
            <arg column="operator" jdbcType="BIGINT" javaType="java.lang.Long" />
            <arg column="rmk" jdbcType="VARCHAR" javaType="java.lang.String" />
        </constructor>
    </resultMap>
    <resultMap id="BaseResultMapPermission" type="com.jw.shiro.bean.TSysPermission" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 19 14:01:10 CST 2018.
        -->
        <constructor >
            <idArg column="permission_id" jdbcType="BIGINT" javaType="java.lang.Long" />
            <arg column="name" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="resource_type" jdbcType="TINYINT" javaType="java.lang.Byte" />
            <arg column="url" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="permission" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="parent_Id" jdbcType="BIGINT" javaType="java.lang.Long" />
            <arg column="parent_Ids" jdbcType="VARCHAR" javaType="java.lang.String" />
            <arg column="available" jdbcType="BIT" javaType="java.lang.Boolean" />
            <arg column="crt_time" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
            <arg column="modf_time" jdbcType="TIMESTAMP" javaType="java.sql.Timestamp" />
            <arg column="operator" jdbcType="BIGINT" javaType="java.lang.Long" />
            <arg column="rmk" jdbcType="VARCHAR" javaType="java.lang.String" />
        </constructor>
    </resultMap>
    <sql id="Base_Column_List_Permission" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 19 14:01:10 CST 2018.
        -->
        permission_id, name, resource_type, url, permission, parent_Id, parent_Ids, available,
        crt_time, modf_time, operator, rmk
    </sql>
    <sql id="Base_Column_List_Role" >
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 19 14:01:10 CST 2018.
        -->

    </sql>
    <select id="selectRoleByUserName" parameterType="java.lang.String" resultMap="BaseResultMapRole">
        SELECT
        r.role_id, r.role, r.description, r.available, r.crt_time, r.modf_time, r.operator, r.rmk
        FROM
            t_user_info u,
            t_sys_user_role rl,
            t_sys_role r
        WHERE
            u.user_name = #{userName,jdbcType=VARCHAR}
        AND u.u_id = rl.u_id
        and rl.role_id = r.role_id;
    </select>

    <select id="selectPermissionByRoleId" parameterType="java.lang.Long" resultMap="BaseResultMapPermission">
        SELECT
        p.permission_id, p.name, p.resource_type, p.url, p.permission, p.parent_Id, p.parent_Ids, p.available,
        p.crt_time, p.modf_time, p.operator, p.rmk
        FROM
        t_sys_permission p,
        t_sys_role_permission rl,
        t_sys_role r
        WHERE
        r.role_id = #{roleId, jdbcType=BIGINT}
        AND p.permission_id = rl.permission_id
        and rl.role_id = r.role_id;
    </select>

</mapper>